---
aliases: TiDB 选择主键时应遵守的原则
created_at: 2023-08-08 17:01
tags: tidb, principle
---

# Content

- 在表内定义一个主键或唯一索引
- 尽量选择有意义的列作为主键
- 出于为性能考虑，尽量避免存储超宽表，表的字段数不建议超过60个，建议单行的总数据大小不要超过64K，数据长度过大的字段最好拆到另外的表
- 不推荐使用复杂的数据类型
- 需要 JOIN 的字段，数据类型保障绝对一致，避免隐式转换
- 避免在单个单调数据列上定义主键，因为使用单个单调数据列（例如 AUTO_INCREMENT 的列）来定义主键有可能会对写性能产生负面影响。可能的话，使用 AUTO_RANDOM 替换（这会失去主键的连续和递增性）
- 如果必需再单个单调列上创建索引，且有大量写入的话，请不要将这个单调数据列定义为主键，而是使用 AUTO_RANDOM 创建该表的主键，或使用 SHARD_ROW_ID_BITS 和 PRE_SPLIT_REGIONS 打散 \_tidb_rowid

# References
